{% extends "base.html" %}
{% block title %}{{ post.title }} | My Blog{% endblock %}

{% block content %}
<div class="container mt-5">
  <div class="card mx-auto p-4" style="max-width: 900px;">

    <!-- Ø¹Ù†ÙˆØ§Ù† Ù¾Ø³Øª -->
    <h1 class="text-center mb-3 neon-glow">{{ post.title }}</h1>

    <!-- Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù†ÙˆÛŒØ³Ù†Ø¯Ù‡ Ùˆ ØªØ§Ø±ÛŒØ® -->
    <p class="text-center text-muted">
      âœï¸ <strong>{{ post.author }}</strong>
      | ğŸ•’ {{ post.created_at|date:"Y-m-d H:i" }}
    </p>

    <!-- ØªØµÙˆÛŒØ± Ù¾Ø³Øª -->
    {% if post.image %}
    <div class="text-center mb-4">
      <img src="{{ post.image.url }}" alt="{{ post.title }}" class="post-detail-img">
    </div>
    {% endif %}

    <!-- Ù…Ø­ØªÙˆØ§ÛŒ Ù¾Ø³Øª -->
    <div class="card-text fs-5 mb-4" style="text-align: justify;">
      {{ post.content|linebreaks }}
    </div>

    <!-- Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ Ùˆ ØªÚ¯â€ŒÙ‡Ø§ -->
    <div class="d-flex flex-wrap gap-2 mb-4 justify-content-center">
      <span class="badge bg-info text-dark">ğŸ·ï¸ Ø¯Ø³ØªÙ‡: {{ post.category }}</span>
      {% for tag in post.tags.all %}
      <span class="badge bg-secondary text-light">#{{ tag.name }}</span>
      {% empty %}
      <span class="badge bg-light text-dark">Ø¨Ø¯ÙˆÙ† ØªÚ¯</span>
      {% endfor %}
    </div>

    <!-- Ø¯Ú©Ù…Ù‡ Ù„Ø§ÛŒÚ© -->
    <div class="text-center mb-4">
      <form method="post" action="{% url 'post_like' slug=post.slug %}">
        {% csrf_token %}
        <button type="submit" class="btn btn-outline-info like-btn shadow-glow">
          ğŸ‘ Ù„Ø§ÛŒÚ© ({{ post.likes.count }})
        </button>

      </form>
    </div>

    <!-- Ø¨Ø®Ø´ Ù†Ø¸Ø±Ø§Øª -->
    <div class="comments-section mt-5">
      <h3 class="text-center mb-4 neon-glow">ğŸ’¬ Ù†Ø¸Ø±Ø§Øª Ú©Ø§Ø±Ø¨Ø±Ø§Ù†</h3>

      {% for comment in post.comments.all %}
      <div class="comment-card mb-3 p-3">
        <p>{{ comment.text }}</p>
        <small class="text-muted">ğŸ‘¤ {{ comment.user }} | {{ comment.created_at|date:"Y-m-d H:i" }}</small>
      </div>
      {% empty %}
      <p class="text-center text-muted">Ù‡Ù†ÙˆØ² Ù†Ø¸Ø±ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª.</p>
      {% endfor %}

      {% if request.user.is_authenticated %}
      <div class="card p-3 mt-4 glass-form">
        <form method="post" action="{% url 'add_comment' slug=post.slug %}">
          {% csrf_token %}
          <div class="mb-3">
            <label for="id_text" class="form-label">Ù†Ø¸Ø± Ø´Ù…Ø§</label>
            <textarea name="text" id="id_text" rows="3" class="form-control"></textarea>
          </div>
          <button type="submit" class="btn btn-success">Ø§Ø±Ø³Ø§Ù„ Ù†Ø¸Ø±</button>
        </form>
      </div>
      {% else %}
      <p class="text-center">Ø¨Ø±Ø§ÛŒ Ø«Ø¨Øª Ù†Ø¸Ø± <a href="{% url 'login' %}">ÙˆØ§Ø±Ø¯ Ø´ÙˆÛŒØ¯</a>.</p>
      {% endif %}
    </div>

    <!-- Ø¨Ø§Ø²Ú¯Ø´Øª -->
    <div class="text-center mt-4">
      <a href="{% url 'post_list' %}" class="btn btn-primary">â¬…ï¸ Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù„ÛŒØ³Øª Ù¾Ø³Øªâ€ŒÙ‡Ø§</a>
    </div>

  </div>
</div>
{% endblock %}